<?xml version="1.0"?>
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:s="library://ns.adobe.com/flex/spark">

    <fx:Metadata>
        [Event(name='new', type='flash.events.Event')]
        [Event(name='edit', type='flash.events.Event')]
    </fx:Metadata>
    <s:layout>
        <s:HorizontalLayout verticalAlign="middle"/>
    </s:layout>

    <s:Button id="createButton" width="200" height="200" label="Crear nuevo" click="createNew()" visible="{!model.xml}"/>
    <s:Spacer width="50"/>
    <s:Label text="O"/>
    <s:Spacer width="50"/>
    <s:Button id="selectButton" width="200" height="200" label="Seleccionar ZIP" click="selectZip()" visible="{!model.xml}"/>
    <!--<s:Label text="OR"/>-->

    <fx:Script><![CDATA[
        private var fileRef:FileReference
        private var model:Model = Model.getInstance();

        private function selectZip():void
        {
            fileRef = new FileReference();
            fileRef.browse();
            fileRef.addEventListener(Event.SELECT, onSelect);
        }

        private function onSelect(event:Event):void
        {
            createButton.enabled = selectButton.enabled = false;
            fileRef.addEventListener(Event.COMPLETE, onComplete);
            fileRef.load();
        }

        private function onComplete(event:Event):void
        {
			createButton.enabled = selectButton.enabled = true;
            Zip.getInstance().parseZip(fileRef.data);
            dispatchEvent(new Event("edit"));
        }
        private function createNew():void
        {
            model.xml = new XML(model.baseXML);
            dispatchEvent(new Event("new"));
        }
        ]]></fx:Script>
</s:Group>
